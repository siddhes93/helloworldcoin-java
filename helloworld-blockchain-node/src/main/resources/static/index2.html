<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./css/index2.css">
</head>

<body>
    <div class="container">
        <div class="row">
            <ol class="breadcrumb bm">
                <li>块 - 000000000000000000055882dcf32c5e88f86f474e77a9672d521b63fa6d5e98</li>
            </ol>
        </div>
        <div class="row">
            <div class="panel panel-bm blockAbstract">
                <div class="panel-heading">
                    <div class="panel-heading-title">摘要</div>
                </div>
                <div class="panel-body text-center">
                    <div class="blockAbstract-inner">
                        <div class="blockAbstract-section">
                            <dl>
                                <dt>高度</dt>
                                <dd>
                                    655,000
                                </dd>
                            </dl>
                            <dl>
                                <dt>确认数 </dt>
                                <dd> 1,889 </dd>
                            </dl>
                            <dl>
                                <dt>区块大小</dt>
                                <dd> 1,383,230 <span class="text-muted">Bytes</span></dd>
                            </dl>
                            <dl>
                                <dt>交易数量</dt>
                                <dd> 871,771 <span class="text-muted">Bytes</span></dd>
                            </dl>
                            <dl>
                                <dt> 时间</dt>
                                <dd style="margin-right: 38px;"> 3,998,543 </dd>
                            </dl>
                            <dl>
                                <dt>矿工奖励</dt>
                                <dd> 1,609 </dd>
                            </dl>
                        </div>
                        <div class="blockAbstract-section">
                            <dl>
                                <dt>挖矿难度</dt>
                                <dd> 0x20400000 </dd>
                            </dl>
                            <dl>
                                <dt>随机数</dt>
                                <dd> 52.65 <span class="text-muted">T</span>
                                    /
                                    20.00 <span class="text-muted">T</span>
                                </dd>
                            </dl>
                            <dl>
                                <dt>区块哈希

                                </dt>
                                <dd class="text-monospace"> 0x170e134e </dd>
                            </dl>
                            <dl>
                                <dt>上一个区块哈希
                                </dt>
                                <dd class="text-monospace"> 0x18facc09 </dd>
                            </dl>
                            <dl>
                                <dt>下一个区块哈希
                                </dt>
                                <dd> <a href="#">F2Pool</a> </dd>
                            </dl>
                            <dl>
                                <dt>默克尔树根
                                </dt>
                                <dd class="-btc-time-localization" data-btccom-timestamp="1604234829"
                                    data-toggle="tooltip" title="" data-original-title="UTC: 2020-11-01 12:47:09">
                                    2020-11-01 20:47:09</dd>
                            </dl>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="panel panel-bm blockTxList">
                <div class="panel-heading">
                    <div class="panel-heading-title">
                        交易
                    </div>
                </div>
                <div class="panel-body">
                    <div class="tx-item">
                        <table class="table">
                            <tbody>
                                <tr class="tx-item-summary">
                                    <td>
                                        <a href="#"
                                            class="tx-item-summary-hash" ga-type="transaction">
                                            e22c300080dfb087f44809bc3f80fbba555ec5cccff78f626e12e449ce247f8c
                                        </a>
                                    </td>
                                    <td>
                                        <span class="tx-item-summary-timestamp">1,589 Satoshis/vByte </span>
                                        <span class="tx-item-summary-timestamp">0.00340000 BTC</span>
                                        <span class="tx-item-summary-timestamp -btc-time-localization"
                                            data-btccom-timestamp="1604234829" data-toggle="tooltip" title=""
                                            data-original-title="UTC: 2020-11-01 12:47:09">2020-11-01 20:47:09</span>
                                    </td>
                                </tr>

                                <tr class="txio">
                                    <td>
                                        <ul>
                                            <li>
                                                <a href="#"
                                                    class="txio-address" ga-type="address" ga-target="from block">
                                                    3LmYCUaGEm8HgbtfzT3UxgbJPuAZfF4WGQ</a>
                                                <a href="#"
                                                    class="txio-amount" ga-type="transaction">
                                                    0.3908<span class="text-muted">8240</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </td>
                                    <td>
                                        <i
                                            class="glyphicon glyphicon-chevron-right txio-arrow txio-address-coinbasecome"></i>
                                        <ul>
                                            <li>
                                                <a href="#"
                                                    class="txio-address" ga-type="address">
                                                    36dJq3VVyS8FEFTiphxEGJRQhD2BcP78sL
                                                </a>
                                                <a href="#"
                                                    class="txio-amount" ga-type="transaction">
                                                    0.0018<span class="text-muted">7266</span>
                                                </a>
                                            </li>
                                            <li>
                                                <a href="#"
                                                    class="txio-address" ga-type="address">
                                                    3M4fnWFqADtS4QEiZteNQb1DWfGfYAAHGF
                                                </a>
                                                <a href="#"
                                                    class="txio-amount" ga-type="transaction">
                                                    0.3856<span class="text-muted">0974</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </td>
                                </tr>

                                <tr class="tx-item-footer">
                                    <td class="tx-item-footer-note">
                                        <p class="tx-item-footer-note-inner">
                                        </p>
                                    </td>
                                    <td class="tx-item-footer-additional">

                                    </td>
                                </tr>
                                <tr class="tx-item-footer">
                                    <td class="tx-item-footer-note"></td>
                                    <td class="tx-item-footer-additional">

                                        <span class="tx-item-footer-additional-box">
                                            0.38748240
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                </div>
            </div>
        </div>
    </div>
    <script src="./js/jQuery.js"></script>
    <script>
        let txt1 = location.search.substr(0).split('=')
        document.querySelector("body > div > div:nth-child(1) > ol > li").innerHTML = txt1[1];
        let blockAbstract_inner = document.querySelector('.blockAbstract-inner')
        var reqJson = '{"blockHash":"'+ txt1[1] + '"}';
        var settings = {
            "url": "/Api/Blockchain/QueryBlockDtoByBlockHash",
            "method": "post",
            "timeout": 0,
            "dataType": "json",
            "async": false,
            "headers": {
                "Content-Type": "application/json"
            },
            "data": reqJson,
        };

        $.ajax(settings).done(function (response) {
            let res = response.result.blockDto
            let txt = `                        <div class="blockAbstract-section">
                            <dl>
                                <dt>高度</dt>
                                <dd>
                                    ${res.height}
                                 </dd>
                            </dl>
                            <dl>
                                <dt>确认数 </dt>
                                <dd> ${res.confirmCount} </dd>
                            </dl>
                            <dl>
                                <dt>区块大小</dt>
                                <dd> ${res.blockSize}</dd>
                            </dl>
                                                                <dl>
                                    <dt>交易数量</dt>
                                    <dd> ${res.transactionCount}</dd>
                                </dl>
                                <dl>
                                    <dt> 时间</dt>
                                    <dd >${res.time} </dd>
                                </dl>
                            <dl>
                                <dt>矿工奖励</dt>
                                <dd> ${res.minerIncentiveValue} </dd>
                            </dl>
                        </div>
                        <div class="blockAbstract-section">
                            <dl>
                                <dt>挖矿难度</dt>
                                                                        <dd>${res.minerDifficulty} </dd>
                                                                </dl>
                            <dl>
                                <dt>随机数</dt>
                                                                        <dd> ${res.nonce}
                            </dl>
                            <dl>
                                <dt>区块哈希

                                </dt>
                                <dd class="text-monospace"> ${res.hash} </dd>
                            </dl>
                            <dl>
                                <dt>上一个区块哈希
                                </dt>
                                <dd class="text-monospace"> ${res.previousBlockHash} </dd>
                            </dl>
                            <dl>
                                <dt>下一个区块哈希
                                </dt>
                                <dd> <a href="#">${res.nextBlockHash || ''}</a> </dd>
                            </dl>
                            <dl>
                                <dt>默克尔树根
                                </dt>
                                <dd class="-btc-time-localization" data-btccom-timestamp="1604234829" data-toggle="tooltip" title="" data-original-title="UTC: 2020-11-01 12:47:09">${res.merkleTreeRoot}</dd>
                            </dl>
                        </div>`
            blockAbstract_inner.innerHTML = txt;
        });

        var reqJson = '{ "blockHash": "'+ txt1[1] +'", "pageCondition": { "from": 1, "size": 10 } }';
        var settings = {
            "url": "/Api/Blockchain/QueryTransactionListByBlockHashTransactionHeight",
            "method": "post",
            "async": false,
            "timeout": 0,
            "headers": {
                "Content-Type": "application/json"
            },
            "data": reqJson,
        };

        let panel = document.querySelector("body > div > div:nth-child(3) > div > div.panel-body")
        $.ajax(settings).done(function (response) {
            let res = response.result.transactionViewList
            let txt = ''
            for (let index = 0; index < res.length; index++) {
                let re = res[index]
                txt+= `                    <div class="tx-item">
                        <table class="table">
                            <tbody>
                                <tr class="tx-item-summary">
                                    <td>
                                        <a href="#"
                                            class="tx-item-summary-hash" ga-type="transaction">
                                            ${re.transactionHash}
                                        </a>
                                    </td>
                                    <td>
                                        <span class="tx-item-summary-timestamp">${re.transactionType}</span>
                                        <span class="tx-item-summary-timestamp">${re.transactionFee} HelloworldCoin</span>
                                        <span class="tx-item-summary-timestamp -btc-time-localization"
                                            data-btccom-timestamp="1604234829" data-toggle="tooltip" title=""
                                            data-original-title="UTC: 2020-11-01 12:47:09">${re.blockTime}</span>
                                    </td>
                                </tr> `;

                txt+= `        <tr class="txio">
                                    <td>
                                        <ul>`;

                //txt+= `                      <li>
                //                                <a href="#"
                //                                    class="txio-address" ga-type="address" ga-target="from block">
                //                                    ${re.transactionOutputViewList[0].address}</a>
                //                                <a href="#"
                //                                    class="txio-amount" ga-type="transaction">
                //                                    <span class="text-muted">${re.transactionOutputViewList[0].value}</span>
                //                                </a>
                //                            </li>`;
                                            if(re.transactionInputViewList != null){
                                            for (let i2 = 0; i2 < re.transactionInputViewList.length; i2++) {
                txt+= `                      <li>
                                                <a href="#"
                                                    class="txio-address" ga-type="address" ga-target="from block">
                                                    ${re.transactionInputViewList[i2].address}</a>
                                                <a href="#"
                                                    class="txio-amount" ga-type="transaction">
                                                    <span class="text-muted">${re.transactionInputViewList[i2].value}</span>
                                                </a>
                                            </li>`;
                                            }
                                            }

                txt+= `                  </ul>
                                    </td>
                                    <td>
                                        <i
                                            class="glyphicon glyphicon-chevron-right txio-arrow txio-address-coinbasecome"></i>
                                        <ul>`;

                //txt+= `                      <li>
                //                                <a href="#"
                //                                    class="txio-address" ga-type="address">
                //                                    ${re.transactionOutputViewList[0].address}
                //                                </a>
                //                                <a href="#"
                //                                    class="txio-amount" ga-type="transaction">
                //                                    <span class="text-muted">${re.transactionOutputViewList[0].value}</span>
                //                                </a>
                //                            </li>`;

                                            if(re.transactionOutputViewList != null){
                                            for (let i2 = 0; i2 < re.transactionOutputViewList.length; i2++) {
                txt+= `                      <li>
                                                <a href="#"
                                                    class="txio-address" ga-type="address" ga-target="from block">
                                                    ${re.transactionOutputViewList[i2].address}</a>
                                                <a href="#"
                                                    class="txio-amount" ga-type="transaction">
                                                    <span class="text-muted">${re.transactionOutputViewList[i2].value}</span>
                                                </a>
                                            </li>`;
                                            }
                                            }

                 txt+= `                 </ul>
                                    </td>
                                </tr> `;

                txt+= `         <tr class="tx-item-footer">
                                    <td class="tx-item-footer-note">
                                        <p class="tx-item-footer-note-inner">
                                        </p>
                                    </td>
                                    <td class="tx-item-footer-additional">

                                    </td>
                                </tr>
                                <tr class="tx-item-footer">
                                    <td class="tx-item-footer-note">
                                        <span class="tx-item-footer-additional-box" style="    float: right;">
                                            ${re.transactionInputValues}
                                        </span>
                                        </td>
                                    <td class="tx-item-footer-additional">

                                        <span class="tx-item-footer-additional-box">
                                            ${re.transactionOutputValues}
                                        </span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>`
            }
            panel.innerHTML = txt + `<div class="page-nav">
                                        <ul id="page-pagination" class="pagination-sm pagination"><li class="first disabled"><a href="?page=1&amp;order_by=tx_block_idx&amp;asc=1">&lt;&lt;</a></li><li class="prev disabled"><a href="?page=1&amp;order_by=tx_block_idx&amp;asc=1">&lt;</a></li><li class="page active"><a href="?page=1&amp;order_by=tx_block_idx&amp;asc=1">1</a></li><li class="next"><a href="?page=2&amp;order_by=tx_block_idx&amp;asc=1">&gt;</a></li><li class="last"><a href="?page=81&amp;order_by=tx_block_idx&amp;asc=1">&gt;&gt;</a></li></ul>
                                     </div>`
        });
    </script>
</body>

</html>